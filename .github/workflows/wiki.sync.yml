- name: Kontrola změn ve wiki
        id: check
        run: |
          set -e
          # Pro workflow_dispatch vždy pokračuj
          if [ "${{ github.event_name }}" = "workflow_dispatch" ]; then
            echo "changed=true" >> "$GITHUB_OUTPUT"
            echo "🔔 Manuální spuštění - pokračuji se synchronizací."
            exit 0
          fi
          
          # Pro schedule event kontroluj, jestli byly změny od poslední úspěšné synchronizace
          if [ "${{ github.event_name }}" = "schedule" ]; then
            # Zkus najít poslední úspěšný sync commit
            LAST_SYNC=$(git log --grep="Synchronizace wiki:" --format="%H" -1 2>/dev/null || echo "")
            
            if [ -n "$LAST_SYNC" ]; then
              CHANGED=$(git diff --name-only "$LAST_SYNC" HEAD -- content/wiki public/wiki | wc -l)
              if [ "$CHANGED" -gt 0 ]; then
                echo "changed=true" >> "$GITHUB_OUTPUT"
                echo "🔔 Schedule: Detekováno $CHANGED změn od posledního syncu."
              else
                echo "changed=false" >> "$GITHUB_OUTPUT"
                echo "✅ Schedule: Žádné nové změny od posledního syncu."
                exit 0
              fi
            else
              echo "changed=true" >> "$GITHUB_OUTPUT"
              echo "🔔 Schedule: První sync, pokračuji."
            fi
            exit 0
          fi
